"""
–ü—Ä–æ—Å—Ç–∞—è –≤–µ—Ä—Å–∏—è —é—Ä–∏–¥–∏—á–µ—Å–∫–æ–≥–æ –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–∞ –±–µ–∑ –ø–æ–ª–Ω–æ–π –º–æ–¥–µ–ª–∏ Saiga-2.
–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –æ—Ç–≤–µ—Ç—ã –Ω–∞ –æ—Å–Ω–æ–≤–µ –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ —Å –ø–æ–º–æ—â—å—é —à–∞–±–ª–æ–Ω–æ–≤.
"""

import logging
from typing import List, Dict, Any, Optional
import re

# Configure logging
logging.basicConfig(level=logging.INFO)
logger = logging.getLogger(__name__)


class SimpleLawyer:
    """
    –ü—Ä–æ—Å—Ç–æ–π —é—Ä–∏–¥–∏—á–µ—Å–∫–∏–π –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç –¥–ª—è MVP.
    –ò—Å–ø–æ–ª—å–∑—É–µ—Ç —à–∞–±–ª–æ–Ω—ã –∏ –Ω–∞–π–¥–µ–Ω–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –æ—Ç–≤–µ—Ç–æ–≤.
    """
    
    def __init__(self):
        self.templates = self._load_response_templates()
    
    def _load_response_templates(self) -> Dict[str, str]:
        """–ó–∞–≥—Ä—É–∑–∫–∞ —à–∞–±–ª–æ–Ω–æ–≤ –æ—Ç–≤–µ—Ç–æ–≤ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ –≤–æ–ø—Ä–æ—Å–æ–≤."""
        return {
            "definition": """
üìã **–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ:**

{content}

üìñ **–ò—Å—Ç–æ—á–Ω–∏–∫:** {source}

‚úÖ **–ó–∞–∫–ª—é—á–µ–Ω–∏–µ:** –ù–∞ –æ—Å–Ω–æ–≤–µ –Ω–∞–π–¥–µ–Ω–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –≤—ã–≤–æ–¥, —á—Ç–æ {summary}.
            """,
            
            "rights": """
‚öñÔ∏è **–ü—Ä–∞–≤–∞ –∏ –æ–±—è–∑–∞–Ω–Ω–æ—Å—Ç–∏:**

{content}

üìñ **–ü—Ä–∞–≤–æ–≤–∞—è –æ—Å–Ω–æ–≤–∞:** {source}

üí° **–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ:** –î–∞–Ω–Ω—ã–µ –ø–æ–ª–æ–∂–µ–Ω–∏—è –æ–∑–Ω–∞—á–∞—é—Ç, —á—Ç–æ {summary}.
            """,
            
            "procedure": """
üìù **–ü–æ—Ä—è–¥–æ–∫ –¥–µ–π—Å—Ç–≤–∏–π:**

{content}

üìñ **–ù–æ—Ä–º–∞—Ç–∏–≤–Ω–∞—è –æ—Å–Ω–æ–≤–∞:** {source}

‚ö° **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:** –î–ª—è —Å–æ–±–ª—é–¥–µ–Ω–∏—è —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π –∑–∞–∫–æ–Ω–æ–¥–∞—Ç–µ–ª—å—Å—Ç–≤–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ {summary}.
            """,
            
            "general": """
üìö **–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –∏–∑ –ø—Ä–∞–≤–æ–≤—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤:**

{content}

üìñ **–ò—Å—Ç–æ—á–Ω–∏–∫:** {source}

üéØ **–í—ã–≤–æ–¥:** {summary}
            """
        }
    
    def _determine_question_type(self, question: str) -> str:
        """–û–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Ç–∏–ø –≤–æ–ø—Ä–æ—Å–∞ –¥–ª—è –≤—ã–±–æ—Ä–∞ –ø–æ–¥—Ö–æ–¥—è—â–µ–≥–æ —à–∞–±–ª–æ–Ω–∞."""
        question_lower = question.lower()
        
        # –ö–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞ –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ç–∏–ø–∞ –≤–æ–ø—Ä–æ—Å–∞
        if any(word in question_lower for word in ['—á—Ç–æ —Ç–∞–∫–æ–µ', '–ø–æ–Ω—è—Ç–∏–µ', '–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ', '—á—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç']):
            return "definition"
        
        elif any(word in question_lower for word in ['–ø—Ä–∞–≤–∞', '–æ–±—è–∑–∞–Ω–Ω–æ—Å—Ç–∏', '–º–æ–∂–µ—Ç –ª–∏', '–∏–º–µ–µ—Ç –ø—Ä–∞–≤–æ', '–æ–±—è–∑–∞–Ω']):
            return "rights"
        
        elif any(word in question_lower for word in ['–∫–∞–∫', '–ø–æ—Ä—è–¥–æ–∫', '–ø—Ä–æ—Ü–µ–¥—É—Ä–∞', '–∫–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º', '—Å–ø–æ—Å–æ–±']):
            return "procedure"
        
        else:
            return "general"
    
    def _extract_key_concepts(self, question: str, content: str) -> str:
        """–ò–∑–≤–ª–µ–∫–∞–µ—Ç –∫–ª—é—á–µ–≤—ã–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏ –¥–ª—è —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è —Ä–µ–∑—é–º–µ."""
        # –ü—Ä–æ—Å—Ç–æ–µ –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –∫–ª—é—á–µ–≤—ã—Ö –ø–æ–Ω—è—Ç–∏–π
        question_lower = question.lower()
        
        # –ò—â–µ–º –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –≤ —Ç–µ–∫—Å—Ç–µ
        definitions = re.findall(r'([–ê-–Ø][–∞-—è\s]+) - —ç—Ç–æ ([^.]+\.)', content)
        if definitions:
            concept, definition = definitions[0]
            return f"{concept.strip()} {definition.strip()}"
        
        # –ò—â–µ–º –æ—Å–Ω–æ–≤–Ω—ã–µ –ø–æ–ª–æ–∂–µ–Ω–∏—è
        if '–ø—Ä–∞–≤–æ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏' in question_lower:
            return "–ø—Ä–∞–≤–æ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏ –≤–∫–ª—é—á–∞–µ—Ç –ø—Ä–∞–≤–∞ –≤–ª–∞–¥–µ–Ω–∏—è, –ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∏ —Ä–∞—Å–ø–æ—Ä—è–∂–µ–Ω–∏—è –∏–º—É—â–µ—Å—Ç–≤–æ–º"
        
        elif '–æ–±—è–∑–∞—Ç–µ–ª—å—Å—Ç–≤–æ' in question_lower:
            return "–æ–±—è–∑–∞—Ç–µ–ª—å—Å—Ç–≤–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –ø—Ä–∞–≤–æ–≤—É—é —Å–≤—è–∑—å –º–µ–∂–¥—É –∫—Ä–µ–¥–∏—Ç–æ—Ä–æ–º –∏ –¥–æ–ª–∂–Ω–∏–∫–æ–º"
        
        elif '–¥–æ–≥–æ–≤–æ—Ä' in question_lower:
            return "–¥–æ–≥–æ–≤–æ—Ä —è–≤–ª—è–µ—Ç—Å—è —Å–æ–≥–ª–∞—à–µ–Ω–∏–µ–º —Å—Ç–æ—Ä–æ–Ω –æ–± —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–∏, –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –∏–ª–∏ –ø—Ä–µ–∫—Ä–∞—â–µ–Ω–∏–∏ –≥—Ä–∞–∂–¥–∞–Ω—Å–∫–∏—Ö –ø—Ä–∞–≤ –∏ –æ–±—è–∑–∞–Ω–Ω–æ—Å—Ç–µ–π"
        
        elif '–∑–∞—â–∏—Ç–∞' in question_lower and '–ø—Ä–∞–≤' in question_lower:
            return "–∑–∞—â–∏—Ç–∞ –≥—Ä–∞–∂–¥–∞–Ω—Å–∫–∏—Ö –ø—Ä–∞–≤ –æ—Å—É—â–µ—Å—Ç–≤–ª—è–µ—Ç—Å—è —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ —Å–ø–æ—Å–æ–±–∞–º–∏, –ø—Ä–µ–¥—É—Å–º–æ—Ç—Ä–µ–Ω–Ω—ã–º–∏ –∑–∞–∫–æ–Ω–æ–º"
        
        else:
            # –ë–µ—Ä–µ–º –ø–µ—Ä–≤—ã–µ 100 —Å–∏–º–≤–æ–ª–æ–≤ –∫–∞–∫ —Ä–µ–∑—é–º–µ
            sentences = content.split('.')[:2]
            return '. '.join(sentences) + '.' if sentences else "—Å–º. –ø–æ–ª–Ω—ã–π —Ç–µ–∫—Å—Ç –≤—ã—à–µ"
    
    def generate_answer(self, question: str, context_chunks: List[Dict[str, Any]] = None) -> Dict[str, Any]:
        """
        –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –æ—Ç–≤–µ—Ç –Ω–∞ –æ—Å–Ω–æ–≤–µ –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤.
        
        Args:
            question: –í–æ–ø—Ä–æ—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            context_chunks: –ù–∞–π–¥–µ–Ω–Ω—ã–µ —Ñ—Ä–∞–≥–º–µ–Ω—Ç—ã –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
            
        Returns:
            Dict —Å –æ—Ç–≤–µ—Ç–æ–º –∏ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–º–∏
        """
        try:
            if not context_chunks:
                return {
                    'answer': self._generate_no_context_answer(question),
                    'context_used': [],
                    'question': question,
                    'model_used': 'Simple Template-based System',
                    'context_count': 0
                }
            
            # –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ç–∏–ø –≤–æ–ø—Ä–æ—Å–∞
            question_type = self._determine_question_type(question)
            
            # –ë–µ—Ä–µ–º —Å–∞–º—ã–π —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–π —Ñ—Ä–∞–≥–º–µ–Ω—Ç
            best_chunk = context_chunks[0]
            content = best_chunk['chunk']
            source = best_chunk['metadata']['source']
            
            # –ò–∑–≤–ª–µ–∫–∞–µ–º –∫–ª—é—á–µ–≤—ã–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏
            summary = self._extract_key_concepts(question, content)
            
            # –í—ã–±–∏—Ä–∞–µ–º –∏ –∑–∞–ø–æ–ª–Ω—è–µ–º —à–∞–±–ª–æ–Ω
            template = self.templates.get(question_type, self.templates['general'])
            
            answer = template.format(
                content=content,
                source=source,
                summary=summary
            )
            
            # –î–æ–±–∞–≤–ª—è–µ–º –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏ –µ—Å–ª–∏ –µ—Å—Ç—å
            if len(context_chunks) > 1:
                answer += "\n\nüìé **–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏:**"
                for chunk in context_chunks[1:3]:  # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –¥–æ 2 –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤
                    answer += f"\n‚Ä¢ {chunk['metadata']['source']} (—Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç—å: {chunk['score']:.2f})"
            
            # –î–æ–±–∞–≤–ª—è–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –¥–∏—Å–∫–ª–µ–π–º–µ—Ä
            answer += "\n\n" + self._get_disclaimer()
            
            return {
                'answer': answer,
                'context_used': context_chunks,
                'question': question,
                'model_used': 'Simple Template-based System',
                'context_count': len(context_chunks),
                'question_type': question_type
            }
            
        except Exception as e:
            logger.error(f"Error generating answer: {str(e)}")
            return {
                'answer': f'–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –≤–∞—à–µ–≥–æ –≤–æ–ø—Ä–æ—Å–∞: {str(e)}',
                'context_used': context_chunks or [],
                'error': str(e),
                'question': question,
                'model_used': 'Simple Template-based System'
            }
    
    def _generate_no_context_answer(self, question: str) -> str:
        """–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –æ—Ç–≤–µ—Ç –∫–æ–≥–¥–∞ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω."""
        return f"""
‚ùì **–ö —Å–æ–∂–∞–ª–µ–Ω–∏—é, –≤ –±–∞–∑–µ –ø—Ä–∞–≤–æ–≤—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è, –Ω–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ –æ—Ç–≤–µ—á–∞—é—â–∞—è –Ω–∞ –≤–∞—à –≤–æ–ø—Ä–æ—Å:**
"{question}"

üîç **–í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã:**
‚Ä¢ –í–æ–ø—Ä–æ—Å –∫–∞—Å–∞–µ—Ç—Å—è —Å–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–æ–π –æ–±–ª–∞—Å—Ç–∏ –ø—Ä–∞–≤–∞, –Ω–µ –æ—Ö–≤–∞—á–µ–Ω–Ω–æ–π –≤ —Ç–µ–∫—É—â–µ–π –±–∞–∑–µ
‚Ä¢ –ù–µ–æ–±—Ö–æ–¥–∏–º–æ –ø–µ—Ä–µ—Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∞—Ç—å –≤–æ–ø—Ä–æ—Å –±–æ–ª–µ–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ
‚Ä¢ –¢—Ä–µ–±—É–µ—Ç—Å—è —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ –±–∞–∑—ã –ø—Ä–∞–≤–æ–≤—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤

üí° **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
‚Ä¢ –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–µ—Ä–µ—Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∞—Ç—å –≤–æ–ø—Ä–æ—Å, –∏—Å–ø–æ–ª—å–∑—É—è –±–æ–ª–µ–µ –æ–±—â–∏–µ —é—Ä–∏–¥–∏—á–µ—Å–∫–∏–µ —Ç–µ—Ä–º–∏–Ω—ã
‚Ä¢ –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ –∫–≤–∞–ª–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–æ–º—É —é—Ä–∏—Å—Ç—É –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–π –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏
‚Ä¢ –ò–∑—É—á–∏—Ç–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ —Ä–∞–∑–¥–µ–ª—ã –ì—Ä–∞–∂–¥–∞–Ω—Å–∫–æ–≥–æ –∫–æ–¥–µ–∫—Å–∞ –†–µ—Å–ø—É–±–ª–∏–∫–∏ –ö–∞–∑–∞—Ö—Å—Ç–∞–Ω

{self._get_disclaimer()}
        """
    
    def _get_disclaimer(self) -> str:
        """–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –¥–∏—Å–∫–ª–µ–π–º–µ—Ä."""
        return """
‚ö†Ô∏è **–í–ê–ñ–ù–û:** –î–∞–Ω–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –Ω–æ—Å–∏—Ç –∏—Å–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ —Å–ø—Ä–∞–≤–æ—á–Ω—ã–π —Ö–∞—Ä–∞–∫—Ç–µ—Ä –∏ –Ω–µ —è–≤–ª—è–µ—Ç—Å—è —é—Ä–∏–¥–∏—á–µ—Å–∫–æ–π –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–µ–π. –î–ª—è —Ä–µ—à–µ–Ω–∏—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö –ø—Ä–∞–≤–æ–≤—ã—Ö –≤–æ–ø—Ä–æ—Å–æ–≤ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –æ–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ –∫–≤–∞–ª–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–æ–º—É —é—Ä–∏—Å—Ç—É –∏–ª–∏ –∞–¥–≤–æ–∫–∞—Ç—É.
        """
    
    def chat(self, question: str, context_chunks: List[Dict[str, Any]] = None) -> str:
        """
        –ü—Ä–æ—Å—Ç–æ–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —á–∞—Ç–∞.
        
        Args:
            question: –í–æ–ø—Ä–æ—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            context_chunks: –ù–∞–π–¥–µ–Ω–Ω—ã–µ —Ñ—Ä–∞–≥–º–µ–Ω—Ç—ã
            
        Returns:
            –û—Ç–≤–µ—Ç –≤ —Ç–µ–∫—Å—Ç–æ–≤–æ–º —Ñ–æ—Ä–º–∞—Ç–µ
        """
        result = self.generate_answer(question, context_chunks)
        return result['answer']


# –ì–ª–æ–±–∞–ª—å–Ω—ã–π —ç–∫–∑–µ–º–ø–ª—è—Ä
simple_lawyer = SimpleLawyer()


def generate_answer(question: str, context_chunks: List[Dict[str, Any]] = None) -> Dict[str, Any]:
    """
    –£–¥–æ–±–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –æ—Ç–≤–µ—Ç–æ–≤.
    
    Args:
        question: –í–æ–ø—Ä–æ—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        context_chunks: –ù–∞–π–¥–µ–Ω–Ω—ã–µ —Ñ—Ä–∞–≥–º–µ–Ω—Ç—ã –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
        
    Returns:
        Dict —Å –æ—Ç–≤–µ—Ç–æ–º –∏ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–º–∏
    """
    return simple_lawyer.generate_answer(question, context_chunks)


def quick_ask(question: str, context_chunks: List[Dict[str, Any]] = None) -> str:
    """
    –ë—ã—Å—Ç—Ä—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –æ—Ç–≤–µ—Ç–∞.
    
    Args:
        question: –í–æ–ø—Ä–æ—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        context_chunks: –ù–∞–π–¥–µ–Ω–Ω—ã–µ —Ñ—Ä–∞–≥–º–µ–Ω—Ç—ã
        
    Returns:
        –û—Ç–≤–µ—Ç –≤ —Ç–µ–∫—Å—Ç–æ–≤–æ–º —Ñ–æ—Ä–º–∞—Ç–µ
    """
    return simple_lawyer.chat(question, context_chunks)


if __name__ == "__main__":
    # –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã
    print("–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ—Å—Ç–æ–≥–æ —é—Ä–∏–¥–∏—á–µ—Å–∫–æ–≥–æ –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–∞...")
    
    # –¢–µ—Å—Ç–æ–≤—ã–µ –≤–æ–ø—Ä–æ—Å—ã
    test_questions = [
        "–ß—Ç–æ —Ç–∞–∫–æ–µ –ø—Ä–∞–≤–æ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏?",
        "–ö–∞–∫–∏–µ –ø—Ä–∞–≤–∞ –∏–º–µ–µ—Ç —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–∏–∫?",
        "–ö–∞–∫ –∑–∞—â–∏—â–∞—é—Ç—Å—è –≥—Ä–∞–∂–¥–∞–Ω—Å–∫–∏–µ –ø—Ä–∞–≤–∞?",
        "–ß—Ç–æ —Ç–∞–∫–æ–µ –¥–æ–≥–æ–≤–æ—Ä?",
        "–ö–∞–∫–∏–µ –æ–±—è–∑–∞—Ç–µ–ª—å—Å—Ç–≤–∞ —Å—É—â–µ—Å—Ç–≤—É—é—Ç?"
    ]
    
    # –ò–º–∏—Ç–∏—Ä—É–µ–º –Ω–∞–π–¥–µ–Ω–Ω—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç
    mock_context = [{
        'chunk': '–°–æ–±—Å—Ç–≤–µ–Ω–Ω–∏–∫—É –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∞—Ç –ø—Ä–∞–≤–∞ –≤–ª–∞–¥–µ–Ω–∏—è, –ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∏ —Ä–∞—Å–ø–æ—Ä—è–∂–µ–Ω–∏—è —Å–≤–æ–∏–º –∏–º—É—â–µ—Å—Ç–≤–æ–º.',
        'metadata': {'source': 'gk_002.txt'},
        'score': 0.85,
        'rank': 1
    }]
    
    for question in test_questions:
        print(f"\n{'='*50}")
        print(f"–í–æ–ø—Ä–æ—Å: {question}")
        print(f"{'='*50}")
        
        answer = quick_ask(question, mock_context)
        print(answer)
        
        print(f"{'='*50}")